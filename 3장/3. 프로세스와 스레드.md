# 프로세스와 스레드
프로세스는 컴퓨터에서 실행되고 있는 프로그램. CPU 스케줄링의 대상이 되는 작업(task) 용어와 같은 의미로 사용.

스레드는 프로세스 내 작업의 흐름.

메모리에 프로그램이 올라가면 프로세스가 되는 인스턴스화가 일어남.

## 1. 프로세스와 컴파일 과정
프로세스는 프로그램이 메모리에 올라가 인스턴스화 된것.

컴파일러가 컴파일 과정을 통해 컴퓨터가 이해할 수 있는 기계어로 변역해 실행할 수 있는 파일을 만듬.

- c 언어 컴파일 과정

소스코드 파일 -> 전처리 -> 컴파일러 -> 어셈블리어 -> 어셈블러 -> object 코드 + (라이브러리) -> 링커 -> 실행가능 파일

### 전처리
소스코드 주석 제거, #include 등 헤더 파일 병합, 메크로 치환

### 컴파일러
오류 처리, 코드 최적화 작업, 어셈블리어로 변환

### 어셈블러
어셈블리어는 object code로 변환. 확장자는 .o로 만들어짐.

### 링커
프로그램 내의 라이브러리 함수 또는 다른파일들과 object code를 결합해서 실행파일을 만든다. 확장자는 .exe .out

#### 정적 라이브러리, 동적 라이브러리
정적 라이브러리는 프로그램 빌드 할 떄 라이브러리가 제공하는 모든 코드를 실행 파일에 넣는다. 외부 의존도가 낮은 장점. 코드 중복 등 메모리 효율성이 낮은 단점.

동적 라이브러리는 프로그램 실행 시 필요할 때만 DLL이라는 함수 정보를 통해 참조한다. 메모리 효율적 장점. 외부 의존도가 높아지는 단점.

## 2. 프로세스의 상태
### 생성 상태
create.
프로세스가 생성된 상태. fork(), exec() 함수를 통해 생성한다.
이때 PCB가 할당된다.

#### fork()
부모 프로세스의 주소 공간을 그대로 복사. 새로운 자식 프로세스를 생성하는 함수. 주소 공간만 복사함. 부모 프로세스의 비동기 작업 등을 상속하진 않음.

#### exec()
새롭게 프로세스를 생성하는 함수.

### 대기 상태
ready.
메모리 공간이 충분하면 메모리를 할당받고 아니면 그냥 대기.
CPU 스케줄러로부터 소유권이 넘어오기를 기다리는 상태

### 대기 중단 상태
ready suspended.
메모리 부족으로 일시중단 상태.

### 실행 상태
running.
CPU 소유권과 메모리를 할당받고 인스트럭션을 수행 중인 상태.

### 중단 상태
blocked.
이벤트가 발생한 이후 기다리며 프로세스가 차단된 상태.
I/O 디바이스에 의한 인터럽트가 대표적.

### 일시중단 상태
blocked suspended.
대기 중단과 유사함. 중단된 상태에서 프로세스가 실행되려 했지만 메모리 부족으로 일시 중단 상태.

### 종료 상태
terminated.
메모리, CPU 소유권을 모두 놓고가는 상태. 자연스러운 종료도 있지만 부모 프로세스에서 자식 프로세스를 강제시키는 비자발적 종료(abort)도 있다. 

## 3. 프로세스의 메모리 구조
동적 영역(스택, 힙), 정적 영역(데이터 영역, 코드 영역)

### 스택과 힙
동적 할당 된다. 런타임 단계에서 메모리를 할당 받는 것.

스택은 지역 변수, 매개변수, 실행되는 함수에 의해 늘어나거나 줄어드는 메모리 영역. 함수가 호출될 때마다 호출될 때의 환경 등 특정 정보가 스택 영역에 계속 저장된다.
재귀 함수 호출 될 때 새로운 스택 프레임이 생성되어 해당 함수 끼리 간섭 영향이 없다.

힙은 동적으로 할당되는 변수. malloc(), free() 함수를 통해 관리할 수 있다. 동적으로 관리되는 자료 구조는 힙 영역을 사용한다. vector같은 경우 내부적으로 힙을 사용함.

### 데이터 영역과 코드 영역
정적으로 할당되는 영역. 컴파일 단계에서 메모리를 할당하는 것.
데이터 영역은 BSS segment, Data segment, code/text segment로 나뉘어서 저장된다.

BSS segment는 전역 변수 또는 static, const로 선언되어 있고 0으로 초기화 또는 초기화가 안된 변수들이 여기 할당된다.

Data segment는 전역 변수 또는 static, const로 선언되어 있고 0이 아닌 값으로 초기화된 변수들이 여기 할당된다.

code segment는 프로그램의 코드가 들어간다.

## 4. PCB
Process Control Block.
운영체제에서 프로세스에 대한 메타데이터를 저장한 '데이터'이다.
프로세스가 생성되면 운영체제는 PCB를 만든다. 중요정보여서 커널 스택의 가장 앞부분에서 관리함.

### PCB의 구조
- 프로세스 스케줄링 상태
- 프로세스 ID
- 프로세스 권한
- 프로그램 카운터
- CPU 레지스터
- CPU 스케줄링 정보
- 계정 정보
- I/O 상태 정보

### 컨텍스트 스위칭
PCB를 교환하는 과정.

## 5. 멀티프로세싱

## 6. 스레드와 멀티스레딩

## 7. 공유자원과 임계영역

## 8. 교착 상태