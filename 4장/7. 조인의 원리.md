# 조인의 원리

## 1. 중첩 루프 조인(Nested Loop Join)
중첩 for 문과 같은 원리로 조건에 맞는 조인을 하는 방법.
랜덤 접근에 대한 비용이 많이 증가하므로 대용량의 테이블에서는 사용하지 않는다.

## 2. 정렬 병합 조인
각각 테이블을 조인할 필드 기준으로 정렬을 하고 이후에 조인 작업을 수행. 조인 할 때 쓸 적절한 인덱스가 없고 대용량의 테이블을 조인하고 조인 조건으로 <, > 등의 범위 비교 연산자가 있는 경우 사용.

## 3. 해시 조인
해시 테이블을 기반으로 조인하는 방법.
두 개의 테이블을 조인한다고 했을때, 하나의 테이블이 메모리에 전부 들어간다면 보통 중첩 루프 조인보다 효율적.(메모리에 못올리면 디스크 사용비용이 발생)

=, equal 조인에만 사용가능.

MySQL의 해시 조인은 빌드단계, 프로브단계로 나뉜다.

### 빌드 단계
입력 테이블 중 하나를 기반으로 메모리 내 해시 테이블을 빌드하는 단계.

persons과 countries라는 테이블을 조인하면 둘 중에 바이트가 적은 테이블을 기반으로 해시 테이블 빌드. 조인에 사용되는 필드가 해시 테이블의 키.

### 프로브 단계
프로브 단계 동안 레코드 읽기를 수행. 각 레코드에서 키와 일치하는 레코드를 찾아서 결과값으로 반환.

각 테이블을 한번만 읽어서 중첩 루프 조인보다 보통 성능이 좋다. 사용 가능한 메모링양은 시스템 변수 join_buffer_size에 제어되고 런타임에 조정가능.
