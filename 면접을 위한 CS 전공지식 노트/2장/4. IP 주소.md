# IP 주소
## 1. ARP
컴퓨터 간의 통신은 IP 주소에서 ARP를 통해 MAC 주소를 찾아 MAC 주소를 기반으로 통신한다.

ARP(Address Resolution Protocol)란 IP 주소로부터 MAC 주소를 구하는 프로토콜이다.

ARP를 통해 가상의 주소인 IP 주소를 실제 주소인 MAC 주소로 변환한다. 이와 반대로 RARP를 통해 MAC 주소를 IP 주소로 변환하기도 한다.

#### ARP 과정
1. ARP Request 브로드캐스트를 보내서 IP 주소에 해당하는 MAC 주소를 찾는다. 
2. 해당 주소에 맞는 장치가 ARP Reply 유니캐스트를 통해 MAC 주소를 반환한다.

## 2. 홉바이홉 통신
IP 주소를 통해 통신하는 과정을 홉바이홉 통신이라 한다.

라우터의 라우팅 테이블 IP를 기반으로 패킷을 전달하며 목적지까지 도달한다.

### 라우팅 테이블
라우팅 테이블은 라우터에 있고 목적지 정보와 가기위한 방법이 들어있다. 게이트웨이와 목적지에 도달하기 위한 다음 라우터의 정보를 가지고 있다.

### 게이트웨이
서로 다른 통신망, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 컴퓨터나 소프트웨어.

서로 다른 네트워크의 통신 프로토콜을 변환해주는 역할을 하기도 한다.

게이트웨이는 라우팅테이블을 통해 볼 수 있다. 윈도우는 ```netstat -r``` 명령어로 확인 가능.

## 3. IP 주소 체계
IPv4, IPv6로 나뉜다. IPv4는 32bit, IPv6는 64bit로 IP주소를 나타낸다.

### 클래스 기반 할당 방식
처음에는 A,B,C,D,E 다섯 개의 클래스로 구분하는 클래스 기반 할당 방식을 썼다. 앞을 네트워크 주소, 뒤는 호스트 주소.

A, B, C는 일대일 통신, D는 멀티캐스트, E는 예비용

맨 왼쪽 비트는 구분 비트 A는 0, B는 10, C는 110

클래스 A의 범위는 0.0.0.0 ~ 127.255.255.255

12.0.0.0이란 네트워크를 부여받았을 경우. 12.0.0.0, 12.255.255.255를 제외한 12.0.0.1 ~ 12.255.255.254를 컴퓨터에 부여할 수 있는 호스트 주소로 사용가능하다.

그러나 이 방식은 사용하는 주소보다 버리는 주소가 많은 단점이 존재한다. 이를 해소하기 위해 DHCP와 IPv6, NAT이 나온다.

### DHCP
DHCP(Dynamic Host Configuration Protocol)는 IP 주소 및 기타 통신 매개변수를 자동으로 할당하기 위한 네트워크 관리 프로토콜이다. 인터넷에 접속할 때 마다 자동으로 IP 주소를 할당할 수 있다.

많은 라우터와 게이트웨이 장비에 DHCP 기능이 있다. 대부분 가정에서 이를 이용해 IP를 할당한다.

### NAT
NAT(Network Address Translation)는 패킷이 라우팅 장치를 통해 전송되는 동안 패킷의 IP 주소 정보를 수정해 다른 주소로 매핑하는 방법이다.

NAT로 사설 IP 공인 IP로 나눠서 많은 주소를 처리한다. NAT를 가능하게 하는 소프트웨어는 ICS, RRAS, Netfilter 등이 있다.

#### 공유기와 NAT
NAT를 쓰는 이유는 여러 대의 호스트가 하나의 공인 IP 주소를 사용해 인터넷에 접속하기 위함이다.

공유기를 사용하면 여러대의 PC를 연결해 사용할 수 있는데 이것은 NAT 기능이 탑재되어 있기 때문이다.

#### NAT을 이용한 보안
내부 네트워크의 IP와 외부에 드러나는 IP가 다르기 때문에 어느정도의 보안이 가능하다.

#### NAT의 단점
여러명이 동시에 하나의 인터넷에 접속하므로 접속 속도가 느려질 수 있다.

## 4. IP 주소를 이용한 위치 정보
네트워크 주소이기 때문에 위치를 추적할 수 있음.